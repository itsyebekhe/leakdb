<!DOCTYPE html>
<html lang="fa" dir="rtl" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø¬Ø³ØªØ¬ÙˆÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¨Ø§Ù†Ú©ÛŒ</title>
    
    <!-- Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@33.003/misc/Farsi-Digits/Vazirmatn-FD-font-face.css" rel="stylesheet" type="text/css" />

    <!-- Config -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: { sans: ['Vazirmatn', 'sans-serif'], mono: ['ui-monospace', 'SFMono-Regular', 'Menlo', 'Monaco', 'Consolas', 'monospace'] },
                    colors: {
                        brand: { 500: '#ef4444', 600: '#dc2626' }, 
                        dark: { 900: '#020617', 800: '#0f172a', 700: '#1e293b' }
                    }
                }
            }
        }
    </script>

    <style>
        body { font-family: 'Vazirmatn', sans-serif; background-color: #020617; -webkit-tap-highlight-color: transparent; }
        .dir-ltr { direction: ltr; text-align: left; }
        
        /* Mobile Tweaks */
        input, select, button { font-size: 16px !important; } /* Prevents iOS Zoom */
        .glass-panel { background: rgba(15, 23, 42, 0.95); border: 1px solid rgba(255, 255, 255, 0.08); }
        
        /* Card Animation */
        .result-card { animation: slideUp 0.3s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes slideUp { to { opacity: 1; transform: translateY(0); } }

        .details-section { transition: max-height 0.3s ease-in-out, padding 0.3s ease-in-out; max-height: 0; overflow: hidden; }
        .details-section.open { max-height: 500px; padding-top: 0.75rem; }
    </style>
</head>
<body class="text-slate-200 min-h-screen overflow-x-hidden selection:bg-red-500/30 selection:text-red-200 pb-20">

    <!-- Header -->
    <header class="fixed top-0 w-full z-50 border-b border-white/5 bg-dark-900/90 backdrop-blur-md">
        <div class="px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-red-600 to-blue-600 flex items-center justify-center text-white shadow-lg shadow-red-500/20 text-lg">
                    <i class="ri-ghost-2-line"></i>
                </div>
                <span class="font-black text-lg text-white tracking-wide">LEAKED <span class="text-red-500">DB</span></span>
            </div>
            <div class="px-2 py-1 rounded-full bg-red-900/20 border border-red-500/20 text-[10px] text-red-400 font-mono">
                PUBLIC DATA
            </div>
        </div>
    </header>

    <main class="pt-24 px-4 container mx-auto max-w-4xl">
        
        <!-- Search Controls -->
        <div class="mb-8">
            <h1 class="text-center text-xl font-bold text-white mb-2 md:mb-4">Ø¬Ø³ØªØ¬ÙˆÛŒ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ <span class="text-red-500">Ø¨Ø§Ù†Ú© Ù…Ù„Øª/Ù…Ù„ÛŒ</span></h1>
            
            <div class="relative bg-dark-900 ring-1 ring-white/10 rounded-2xl p-2 shadow-2xl">
                <!-- Mobile Scope Selector (Chips) -->
                <div class="flex gap-2 overflow-x-auto pb-2 mb-1 scrollbar-hide text-xs md:hidden">
                    <button onclick="setScope('ALL', this)" class="scope-btn active bg-slate-800 text-white px-3 py-1.5 rounded-lg whitespace-nowrap border border-slate-700">ğŸ” Ù‡Ù…Ù‡</button>
                    <button onclick="setScope('NATIONAL_CODE', this)" class="scope-btn text-slate-400 px-3 py-1.5 rounded-lg whitespace-nowrap border border-transparent">ğŸ”¢ Ú©Ø¯ Ù…Ù„ÛŒ</button>
                    <button onclick="setScope('MOBILE', this)" class="scope-btn text-slate-400 px-3 py-1.5 rounded-lg whitespace-nowrap border border-transparent">ğŸ“± Ù…ÙˆØ¨Ø§ÛŒÙ„</button>
                    <button onclick="setScope('FULL_NAME', this)" class="scope-btn text-slate-400 px-3 py-1.5 rounded-lg whitespace-nowrap border border-transparent">ğŸ‘¤ Ù†Ø§Ù…</button>
                </div>

                <select id="search-scope" class="hidden"><option value="ALL">ALL</option><option value="NATIONAL_CODE">NATIONAL_CODE</option><option value="MOBILE">MOBILE</option><option value="FULL_NAME">FULL_NAME</option></select>

                <div class="flex flex-col md:flex-row gap-2">
                    <div class="hidden md:block relative w-40">
                        <select onchange="updateScopeUI(this.value)" class="w-full h-full bg-slate-800 text-slate-300 text-sm rounded-xl px-4 py-3 border-none outline-none cursor-pointer">
                            <option value="ALL">ğŸ” Ù‡Ù…Ù‡</option>
                            <option value="NATIONAL_CODE">ğŸ”¢ Ú©Ø¯ Ù…Ù„ÛŒ</option>
                            <option value="MOBILE">ğŸ“± Ù…ÙˆØ¨Ø§ÛŒÙ„</option>
                            <option value="FULL_NAME">ğŸ‘¤ Ù†Ø§Ù…</option>
                        </select>
                    </div>

                    <input type="text" id="inp-omni" autocomplete="off" placeholder="Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..." 
                        class="w-full bg-transparent border-none text-white text-base md:text-lg rounded-xl focus:ring-0 block px-4 py-3 outline-none placeholder-slate-600 text-center md:text-right font-mono">
                    
                    <button onclick="executeSearch(0)" id="btn-search" class="w-full md:w-auto px-6 py-3 bg-red-600 active:bg-red-700 text-white font-bold rounded-xl shadow-lg shadow-red-500/20 transition-all flex items-center justify-center gap-2">
                        <span class="md:hidden">Ø¬Ø³ØªØ¬Ùˆ</span>
                        <i class="ri-search-2-line text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Disclaimer -->
        <div class="max-w-3xl mx-auto mb-10">
            <div class="bg-red-900/10 border-l-4 border-red-500 rounded-lg p-4 flex items-center gap-4 shadow-lg">
                <i class="ri-alert-fill text-red-400 text-2xl flex-shrink-0"></i>
                <div class="text-xs text-slate-400 text-justify leading-relaxed">
                    <strong class="text-red-400 block mb-1">Ø³Ù„Ø¨ Ù…Ø³Ø¦ÙˆÙ„ÛŒØª:</strong>
                    Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ø¨Ø±Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§ÙØ´Ø§ Ø´Ø¯Ù‡ Ø¨Ø§Ù†Ú©â€ŒÙ‡Ø§ (Ú©Ù‡ Ø¯Ø± Ø³Ø·Ø­ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø¹Ù…ÙˆÙ…ÛŒ Ø´Ø¯Ù‡) Ø·Ø±Ø§Ø­ÛŒ Ø´Ø¯Ù‡ Ø§Ø³Øª. Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØµØ±ÙØ§Ù‹ Ø¬Ù‡Øª ØªØ­Ù‚ÛŒÙ‚Ø§Øª Ø§Ù…Ù†ÛŒØªÛŒ (OSINT) Ø¨ÙˆØ¯Ù‡ Ùˆ Ù‡Ø±Ú¯ÙˆÙ†Ù‡ Ø³ÙˆØ¡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø¨Ø± Ø¹Ù‡Ø¯Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø§Ø³Øª.
                </div>
            </div>
        </div>

        <!-- Results Area -->
        <div id="results-area" class="hidden">
            <div class="flex justify-between items-center mb-4 px-1">
                <h2 class="text-sm font-bold text-white flex items-center gap-2">Ù†ØªØ§ÛŒØ¬ (<span id="res-count">0</span>)</h2>
                <div class="flex gap-2">
                    <button onclick="copyTable()" class="p-2 bg-slate-800 rounded-lg text-slate-300 border border-slate-700 active:scale-95"><i class="ri-file-copy-line"></i></button>
                    <button onclick="exportJSON()" class="p-2 bg-slate-800 rounded-lg text-slate-300 border border-slate-700 active:scale-95"><i class="ri-download-cloud-line"></i></button>
                </div>
            </div>

            <!-- DESKTOP TABLE -->
            <div class="hidden md:block glass-panel rounded-2xl overflow-hidden mb-6 shadow-2xl">
                <div class="overflow-x-auto"><table class="w-full text-left text-sm text-slate-400 whitespace-nowrap"><thead class="bg-dark-900/80 text-slate-200 uppercase font-mono text-xs border-b border-white/5"><tr><th class="px-4 py-4 text-right">Ù†Ø§Ù…</th><th class="px-4 py-4 text-center">Ú©Ø¯ Ù…Ù„ÛŒ</th><th class="px-4 py-4 text-center">Ù…ÙˆØ¨Ø§ÛŒÙ„</th><th class="px-4 py-4 text-right">Ù¾Ø¯Ø±</th><th class="px-4 py-4 text-right">Ø¢Ø¯Ø±Ø³</th><th class="px-4 py-4 text-center">Ø¨Ø§Ù†Ú©</th></tr></thead><tbody id="desktop-tbody" class="divide-y divide-white/5"></tbody></table></div>
            </div>

            <!-- MOBILE CARDS -->
            <div id="mobile-cards" class="md:hidden space-y-3 mb-6"></div>

            <!-- Pagination -->
            <div class="flex justify-between items-center bg-slate-900/50 p-3 rounded-xl border border-white/5">
                <button onclick="changePage(-1)" id="btn-prev" disabled class="px-4 py-2 bg-slate-800 rounded-lg text-xs text-slate-300 disabled:opacity-30">Ù‚Ø¨Ù„ÛŒ</button>
                <span id="page-info" class="text-xs font-mono text-red-400">1</span>
                <button onclick="changePage(1)" id="btn-next" disabled class="px-4 py-2 bg-slate-800 rounded-lg text-xs text-slate-300 disabled:opacity-30">Ø¨Ø¹Ø¯ÛŒ</button>
            </div>
        </div>

        <!-- Status -->
        <div id="status-display" class="hidden py-16 text-center"></div>

    </main>

    <script>
        const HF_DATASET = "yebekhe/bdata";
        const HF_CONFIG = "default";
        const HF_SPLIT = "train";
        const HF_LENGTH = 50; 
        const CITY_CODES = {"169":"Ø¢Ø°Ø±Ø´Ù‡Ø±","170":"Ø§Ø³Ú©Ùˆ","149":"Ø§Ù‡Ø±","150":"Ø§Ù‡Ø±","171":"Ø¨Ø³ØªØ§Ù†â€ŒØ¢Ø¨Ø§Ø¯","168":"Ø¨Ù†Ø§Ø¨","136":"ØªØ¨Ø±ÛŒØ²","137":"ØªØ¨Ø±ÛŒØ²","138":"ØªØ¨Ø±ÛŒØ²","545":"ØªØ±Ú©Ù…Ø§Ù†Ú†Ø§ÛŒ","505":"Ø¬Ù„ÙØ§","636":"Ú†Ø§Ø±Ø§ÙˆÛŒÙ…Ø§Ù‚","164":"Ø³Ø±Ø§Ø¨","165":"Ø³Ø±Ø§Ø¨","172":"Ø´Ø¨Ø³ØªØ±","623":"ØµÙˆÙÛŒØ§Ù†","506":"Ø¹Ø¬Ø¨â€ŒØ´ÛŒØ±","519":"Ú©Ù„ÛŒØ¨Ø±","154":"Ù…Ø±Ø§ØºÙ‡","155":"Ù…Ø±Ø§ØºÙ‡","567":"ÙˆØ±Ø²Ù‚Ø§Ù†","173":"Ù‡Ø±ÛŒØ³","159":"Ù‡Ø´ØªØ±ÙˆØ¯","160":"Ù‡Ø´ØªØ±ÙˆØ¯","604":"Ù‡ÙˆØ±Ø§Ù†Ø¯","274":"Ø§Ø±ÙˆÙ…ÛŒÙ‡","275":"Ø§Ø±ÙˆÙ…ÛŒÙ‡","295":"Ø§Ø´Ù†ÙˆÛŒÙ‡","637":"Ø§Ù†Ø²Ù„","292":"Ø¨ÙˆÚ©Ø§Ù†","492":"Ù¾Ù„Ø¯Ø´Øª","289":"Ù¾ÛŒØ±Ø§Ù†Ø´Ù‡Ø±","677":"ØªØ®Øª Ø³Ù„ÛŒÙ…Ø§Ù†","294":"ØªÚ©Ø§Ø¨","493":"Ú†Ø§ÛŒÙ¾Ø§Ø±Ù‡","279":"Ø®ÙˆÛŒ","280":"Ø®ÙˆÛŒ","288":"Ø³Ø±Ø¯Ø´Øª","284":"Ø³Ù„Ù…Ø§Ø³","285":"Ø³Ù„Ù…Ø§Ø³","638":"Ø³ÛŒÙ„ÙˆØ§Ù†Ù‡","291":"Ø³ÛŒÙ‡â€ŒÚ†Ø´Ù…Ù‡","640":"Ø´ÙˆØ·","293":"Ø´Ø§Ù‡ÛŒÙ†â€ŒØ¯Ú˜","675":"Ú©Ø´Ø§ÙˆØ±Ø²","282":"Ù…Ø§Ú©Ùˆ","283":"Ù…Ø§Ú©Ùˆ","286":"Ù…Ù‡Ø§Ø¨Ø§Ø¯","287":"Ù…Ù‡Ø§Ø¨Ø§Ø¯","296":"Ù…ÛŒØ§Ù†Ø¯ÙˆØ¢Ø¨","297":"Ù…ÛŒØ§Ù†Ø¯ÙˆØ¢Ø¨","290":"Ù†Ù‚Ø¯Ù‡","400":"Ø§Ø³Ø¯Ø¢Ø¨Ø§Ø¯","401":"Ø§Ø³Ø¯Ø¢Ø¨Ø§Ø¯","404":"Ø¨Ù‡Ø§Ø±","405":"Ø¨Ù‡Ø§Ø±","397":"ØªÙˆÛŒØ³Ø±Ú©Ø§Ù†","398":"Ø±Ø²Ù†","399":"Ø±Ø²Ù†","647":"Ø´Ø±Ø§Ø¡","502":"ÙØ§Ù…Ù†ÛŒÙ†","584":"Ù‚Ù„Ù‚Ù„ Ø±ÙˆØ¯","402":"Ú©Ø¨ÙˆØ¯Ø±Ø¢Ù‡Ù†Ú¯","403":"Ú©Ø¨ÙˆØ¯Ø±Ø¢Ù‡Ù†Ú¯","392":"Ù…Ù„Ø§ÛŒØ±","393":"Ù…Ù„Ø§ÛŒØ±","395":"Ù†Ù‡Ø§ÙˆÙ†Ø¯","396":"Ù†Ù‡Ø§ÙˆÙ†Ø¯","386":"Ù‡Ù…Ø¯Ø§Ù†","387":"Ù‡Ù…Ø¯Ø§Ù†","503":"Ø§Ø¨Ø±Ú©ÙˆÙ‡","444":"Ø§Ø±Ø¯Ú©Ø§Ù†","551":"Ø§Ø´Ú©Ø°Ø±","447":"Ø¨Ø§ÙÙ‚","561":"Ø¨Ù‡Ø§Ø¨Ø§Ø¯","445":"ØªÙØª","718":"Ø¯Ø³ØªÚ¯Ø±Ø¯Ø§Ù†","083":"Ø·Ø¨Ø³","446":"Ù…Ù‡Ø±ÛŒØ²","448":"Ù…ÛŒØ¨Ø¯","552":"Ù†ÛŒØ±","543":"Ù‡Ø±Ø§Øª","442":"ÛŒØ²Ø¯","443":"ÛŒØ²Ø¯","051":"Ø¢Ø´ØªÛŒØ§Ù†","052":"Ø§Ø±Ø§Ú©","053":"Ø§Ø±Ø§Ú©","058":"ØªÙØ±Ø´","055":"Ø®Ù…ÛŒÙ†","617":"Ø®Ù†Ø¯Ø§Ø¨","057":"Ø¯Ù„ÛŒØ¬Ø§Ù†","618":"Ø²Ø±Ù†Ø¯ Ù…Ø±Ú©Ø²ÛŒ","059":"Ø³Ø§ÙˆÙ‡","060":"Ø³Ø§ÙˆÙ‡","061":"Ø³Ø±Ø¨Ù†Ø¯","062":"Ø³Ø±Ø¨Ù†Ø¯","544":"ÙØ±Ø§Ù‡Ø§Ù†","056":"Ù…Ø­Ù„Ø§Øª","571":"ÙˆÙØ³","593":"Ù‡Ù†Ø¯ÙˆØ¯Ø±","667":"Ø§Ø¨ÙˆÙ…ÙˆØ³ÛŒ","348":"Ø¨Ø³ØªÚ©","586":"Ø¨Ø´Ø§Ú¯Ø±Ø¯","338":"Ø¨Ù†Ø¯Ø±Ø¹Ø¨Ø§Ø³","339":"Ø¨Ù†Ø¯Ø±Ø¹Ø¨Ø§Ø³","343":"Ø¨Ù†Ø¯Ø±Ù„Ù†Ú¯Ù‡","344":"Ø¨Ù†Ø¯Ø±Ù„Ù†Ú¯Ù‡","346":"Ø¬Ø§Ø³Ú©","337":"Ø­Ø§Ø¬ÛŒâ€ŒØ¢Ø¨Ø§Ø¯","554":"Ø®Ù…ÛŒØ±","469":"Ø±ÙˆØ¯Ø§Ù†","537":"ÙÛŒÙ†","345":"Ù‚Ø´Ù…","470":"Ú¯Ø§ÙˆØ¨Ù†Ø¯ÛŒ","341":"Ù…ÛŒÙ†Ø§Ø¨","342":"Ù…ÛŒÙ†Ø§Ø¨","483":"Ø§Ø²Ù†Ø§","484":"Ø§Ø²Ù†Ø§","557":"Ø§Ø´ØªØ±ÛŒÙ†Ø§Ù†","418":"Ø§Ù„Ø´ØªØ±","416":"Ø§Ù„ÛŒÚ¯ÙˆØ¯Ø±Ø²","417":"Ø§Ù„ÛŒÚ¯ÙˆØ¯Ø±Ø²","412":"Ø¨Ø±ÙˆØ¬Ø±Ø¯","413":"Ø¨Ø±ÙˆØ¬Ø±Ø¯","592":"Ù¾Ø§Ù¾ÛŒ","612":"Ú†ØºÙ„ÙˆÙ†Ø¯ÛŒ","613":"Ú†Ú¯Ù†ÛŒ","406":"Ø®Ø±Ù…â€ŒØ¢Ø¨Ø§Ø¯","407":"Ø®Ø±Ù…â€ŒØ¢Ø¨Ø§Ø¯","421":"Ø¯ÙˆØ±ÙˆØ¯","598":"Ø±ÙˆÙ…Ø´Ú©Ø§Ù†","419":"Ú©ÙˆÙ‡Ø¯Ø´Øª","385":"Ù…Ù„Ø§ÙˆÛŒ","420":"Ù†ÙˆØ±Ø¢Ø¨Ø§Ø¯","528":"ÙˆÛŒØ³ÛŒØ§Ù†","213":"Ø¢Ù…Ù„","214":"Ø¢Ù…Ù„","205":"Ø¨Ø§Ø¨Ù„","206":"Ø¨Ø§Ø¨Ù„","498":"Ø¨Ø§Ø¨Ù„Ø³Ø±","568":"Ø¨Ù†Ø¯Ù¾ÛŒ","711":"Ø¨Ù†Ø¯Ù¾ÛŒ Ø´Ø±Ù‚ÛŒ","217":"Ø¨Ù‡Ø´Ù‡Ø±","218":"Ø¨Ù‡Ø´Ù‡Ø±","221":"ØªÙ†Ú©Ø§Ø¨Ù†","582":"Ø¬ÙˆÛŒØ¨Ø§Ø±","483":"Ú†Ø§Ù„ÙˆØ³","625":"Ú†Ù…Ø³ØªØ§Ù†","576":"Ú†Ù‡Ø§Ø±Ø¯Ø§Ù†Ú¯Ù‡","578":"Ø¯ÙˆØ¯Ø§Ù†Ú¯Ù‡","227":"Ø±Ø§Ù…Ø³Ø±","208":"Ø³Ø§Ø±ÛŒ","209":"Ø³Ø§Ø±ÛŒ","225":"Ø³ÙˆØ§Ø¯Ú©ÙˆÙ‡","577":"Ø´ÛŒØ±Ú¯Ø§Ù‡","712":"Ø¹Ø¨Ø§Ø³â€ŒØ¢Ø¨Ø§Ø¯","215":"Ù‚Ø§Ø¦Ù…Ø´Ù‡Ø±","216":"Ù‚Ø§Ø¦Ù…Ø´Ù‡Ø±","626":"Ú©Ø¬ÙˆØ±","627":"Ú©Ù„Ø§Ø±Ø¯Ø´Øª","579":"Ú¯Ù„ÙˆÚ¯Ø§Ù‡","713":"Ù…ÛŒØ§Ù†Ø¯ÙˆØ±ÙˆØ¯","499":"Ù†Ú©Ø§","222":"Ù†ÙˆØ±","219":"Ù†ÙˆØ´Ù‡Ø±","220":"Ù†ÙˆØ´Ù‡Ø±","500":"Ù‡Ø±Ø§Ø²","501":"Ù‡Ø±Ø§Ø²","623":"Ø¢Ø²Ø§Ø¯Ø´Ù‡Ø±","497":"Ø¢Ù‚â€ŒÙ‚Ù„Ø§","223":"Ø¨Ù†Ø¯Ø±ØªØ±Ú©Ù…Ù†","689":"Ø¨Ù†Ø¯Ø±Ú¯Ø²","487":"Ø±Ø§Ù…ÛŒØ§Ù†","226":"Ø¹Ù„ÛŒâ€ŒØ¢Ø¨Ø§Ø¯","224":"Ú©Ø±Ø¯Ú©ÙˆÛŒ","486":"Ú©Ù„Ø§Ù„Ù‡","211":"Ú¯Ø±Ú¯Ø§Ù†","212":"Ú¯Ø±Ú¯Ø§Ù†","628":"Ú¯Ù…ÛŒØ´Ø§Ù†","202":"Ú¯Ù†Ø¨Ø¯ Ú©Ø§ÙˆÙˆØ³","203":"Ú¯Ù†Ø¨Ø¯ Ú©Ø§ÙˆÙˆØ³","531":"Ù…Ø±Ø§ÙˆÙ‡â€ŒØªÙ¾Ù‡","488":"Ù…ÛŒÙ†ÙˆØ¯Ø´Øª","001":"ØªÙ‡Ø±Ø§Ù†","002":"ØªÙ‡Ø±Ø§Ù†","003":"ØªÙ‡Ø±Ø§Ù†","004":"ØªÙ‡Ø±Ø§Ù†","005":"ØªÙ‡Ø±Ø§Ù†","006":"ØªÙ‡Ø±Ø§Ù†","007":"ØªÙ‡Ø±Ø§Ù†","008":"ØªÙ‡Ø±Ø§Ù†","011":"ØªÙ‡Ø±Ø§Ù† Ø¬Ù†ÙˆØ¨","020":"ØªÙ‡Ø±Ø§Ù† Ø´Ø±Ù‚","025":"ØªÙ‡Ø±Ø§Ù† Ø´Ù…Ø§Ù„","015":"ØªÙ‡Ø±Ø§Ù† ØºØ±Ø¨","043":"Ø¯Ù…Ø§ÙˆÙ†Ø¯","666":"Ø±Ø¨Ø§Ø· Ú©Ø±ÛŒÙ…","489":"Ø³Ø§ÙˆØ¬Ø¨Ù„Ø§Øº","044":"Ø´Ù…ÛŒØ±Ø§Ù†","045":"Ø´Ù…ÛŒØ±Ø§Ù†","048":"Ø´Ù‡Ø±Ø±ÛŒ","049":"Ø´Ù‡Ø±Ø±ÛŒ","490":"Ø´Ù‡Ø±ÛŒØ§Ø±","491":"Ø´Ù‡Ø±ÛŒØ§Ø±","695":"Ø·Ø§Ù„Ù‚Ø§Ù†","659":"ÙÛŒØ±ÙˆØ²Ú©ÙˆÙ‡","031":"Ú©Ø±Ø¬","032":"Ú©Ø±Ø¬","664":"Ú©Ù‡Ø±ÛŒØ²Ú©","717":"Ù†Ø¸Ø±Ø¢Ø¨Ø§Ø¯","041":"ÙˆØ±Ø§Ù…ÛŒÙ†","042":"ÙˆØ±Ø§Ù…ÛŒÙ†","427":"Ø²Ù†Ø¬Ø§Ù†","428":"Ø²Ù†Ø¬Ø§Ù†","507":"Ù…Ù„Ú©Ø§Ù†","158":"Ù…Ø±Ù†Ø¯","615":"Ø§Ø¨Ù‡Ø±","152":"Ù…ÛŒØ§Ù†Ù‡","153":"Ù…ÛŒØ§Ù†Ù‡","333":"Ø§Ø³Ù„Ø§Ù…â€ŒØ¢Ø¨Ø§Ø¯","334":"Ø§Ø³Ù„Ø§Ù…â€ŒØ¢Ø¨Ø§Ø¯","691":"Ø¨Ø§ÛŒÙ†Ú¯Ø§Ù†","322":"Ù¾Ø§ÙˆÙ‡","323":"Ù¾Ø§ÙˆÙ‡","595":"Ø«Ù„Ø§Ø« Ø¨Ø§Ø¨Ø§Ø¬Ø§Ù†ÛŒ","395":"Ø¬ÙˆØ§Ù†Ø±ÙˆØ¯","641":"Ø­Ù…ÛŒÙ„","596":"Ø±ÙˆØ§Ù†Ø³Ø±","336":"Ø³Ø±Ù¾Ù„ Ø°Ù‡Ø§Ø¨","335":"Ø³Ù†Ù‚Ø±","496":"ØµØ­Ù†Ù‡","337":"Ù‚ØµØ±Ø´ÛŒØ±ÛŒÙ†","324":"Ú©Ø±Ù…Ø§Ù†Ø´Ø§Ù‡","325":"Ú©Ø±Ù…Ø§Ù†Ø´Ø§Ù‡","394":"Ú©Ø±Ù†Ø¯","330":"Ú©Ù†Ú¯Ø§ÙˆØ±","332":"Ú¯ÛŒÙ„Ø§Ù†ØºØ±Ø¨","331":"Ù‡Ø±Ø³ÛŒÙ†","127":"Ø§ØµÙÙ‡Ø§Ù†","128":"Ø§ØµÙÙ‡Ø§Ù†","129":"Ø§ØµÙÙ‡Ø§Ù†","108":"Ù†Ø¬Ùâ€ŒØ¢Ø¨Ø§Ø¯","109":"Ù†Ø¬Ùâ€ŒØ¢Ø¨Ø§Ø¯","125":"Ú©Ø§Ø´Ø§Ù†","126":"Ú©Ø§Ø´Ø§Ù†","121":"Ú¯Ù„Ù¾Ø§ÛŒÚ¯Ø§Ù†","119":"Ø´Ù‡Ø±Ø¶Ø§","113":"Ø®Ù…ÛŒÙ†ÛŒâ€ŒØ´Ù‡Ø±","114":"Ø®Ù…ÛŒÙ†ÛŒâ€ŒØ´Ù‡Ø±","110":"ÙÙ„Ø§ÙˆØ±Ø¬Ø§Ù†","111":"ÙÙ„Ø§ÙˆØ±Ø¬Ø§Ù†","118":"Ø§Ø±Ø¯Ø³ØªØ§Ù†","124":"Ù†Ø§Ø¦ÛŒÙ†","510":"Ø´Ø§Ù‡ÛŒÙ†â€ŒØ´Ù‡Ø±","511":"Ø´Ø§Ù‡ÛŒÙ†â€ŒØ´Ù‡Ø±","112":"ÙØ±ÛŒØ¯ÙˆÙ†Ø´Ù‡Ø±","115":"ÙØ±ÛŒØ¯Ù†","541":"Ù…Ø¨Ø§Ø±Ú©Ù‡","122":"Ø®ÙˆØ§Ù†Ø³Ø§Ø±","116":"Ù„Ù†Ø¬Ø§Ù†","117":"Ù„Ù†Ø¬Ø§Ù†"};

        // UTILS
        const toEnglishDigits = (str) => { if (!str) return ""; return String(str).replace(/[Û°-Û¹]/g, w => ['0','1','2','3','4','5','6','7','8','9'][['Û°','Û±','Û²','Û³','Û´','Ûµ','Û¶','Û·','Û¸','Û¹'].indexOf(w)]); };
        const normalizePersian = (text) => { if (!text) return ""; return text.replace(/ÙŠ/g, "ÛŒ").replace(/Ùƒ/g, "Ú©").replace(/Ù‰/g, "ÛŒ").trim(); };
        const copyToClip = (txt) => { navigator.clipboard.writeText(txt); alert('Ú©Ù¾ÛŒ Ø´Ø¯: ' + txt); };
        function processNationalCode(code) {
            if (!code || typeof code !== 'string' && typeof code !== 'number') return { code: '-', city: '' };
            const numCode = parseInt(String(code).trim(), 10);
            const cleanCode = String(numCode).padStart(10, '0');
            const prefix = cleanCode.substring(0, 3);
            return { code: cleanCode, city: CITY_CODES[prefix] || "" };
        }

        // STATE
        let lastResults = [];
        let currentSearchPage = 0;
        let totalSearchResults = 0;
        let activeQueryString = "";

        const omniInput = document.getElementById('inp-omni');
        omniInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') executeSearch(0); });

        // URL PARAMETER HANDLER ---
        function handleUrlQuery() {
            const params = new URLSearchParams(window.location.search);
            const query = params.get('q'); // We will use "?q=..."
            const scope = params.get('scope');

            if (query) {
                // 1. Fill the input box
                document.getElementById('inp-omni').value = query;

                // 2. Set the scope dropdown (if provided)
                if (scope) {
                    document.getElementById('search-scope').value = scope;
                }

                // 3. Run the search automatically
                console.log(`URL Query Detected: Searching for "${query}"`);
                executeSearch(0);
            }
        }

        // --- APP INITIALIZER ---
        function init() {
            // Add any future startup logic here
            console.log("GHOST Engine Initialized.");
        }

        // MOBILE SCOPE UI
        function setScope(val, btn) {
            document.getElementById('search-scope').value = val;
            document.querySelectorAll('.scope-btn').forEach(b => {
                b.classList.remove('bg-slate-800', 'text-white', 'border-slate-700');
                b.classList.add('text-slate-400', 'border-transparent');
            });
            btn.classList.add('bg-slate-800', 'text-white', 'border-slate-700');
        }

        async function executeSearch(page = 0) {
            const rawInput = document.getElementById('inp-omni').value;
            const scope = document.getElementById('search-scope').value;
            const input = toEnglishDigits(normalizePersian(rawInput));
            
            if (!input || input.length < 2) return alert("Ù„Ø·ÙØ§ Ø­Ø¯Ø§Ù‚Ù„ Û² Ú©Ø§Ø±Ø§Ú©ØªØ± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯");

            setLoading(true);
            currentSearchPage = page;

            try {
                if (page === 0) {
                    let c = [];
                    if (scope === 'ALL' || scope === 'NATIONAL_CODE') if (/^\d+$/.test(input)) { 
                        c.push(`NATIONAL_CODE LIKE '%${input}%'`); 
                        if(!input.startsWith('0')) c.push(`NATIONAL_CODE = '${input}'`); 
                    }
                    if (scope === 'ALL' || scope === 'MOBILE') if (/^\d+$/.test(input)) c.push(`MOBILE LIKE '%${input}%'`);
                    if (scope === 'ALL' || scope === 'FULL_NAME') { 
                        c.push(`FULL_NAME LIKE '%${input}%'`); 
                        if(scope === 'ALL') c.push(`FATHER_NAME LIKE '%${input}%'`); 
                    }
                    if (scope === 'ALL') { 
                        c.push(`CITY_NAME LIKE '%${input}%'`); 
                        c.push(`ADDRESS LIKE '%${input}%'`); 
                    }
                    if (c.length === 0) c.push(`FULL_NAME LIKE '%${input}%'`); 
                    activeQueryString = c.join(" OR ");
                }

                const offset = page * HF_LENGTH;
                const url = `https://datasets-server.huggingface.co/filter?dataset=${HF_DATASET}&config=${HF_CONFIG}&split=${HF_SPLIT}&where=${encodeURIComponent(activeQueryString)}&offset=${offset}&length=${HF_LENGTH}`;

                const response = await fetch(url);
                if (!response.ok) throw new Error("API Error");
                
                const json = await response.json();
                renderResults(json.rows.map(r => r.row), json.num_rows_total);

            } catch (error) { showErrorState(error.message); } finally { setLoading(false); }
        }

        function renderResults(rows, totalRows, updateCount = true) {
            lastResults = rows;
            if (updateCount) totalSearchResults = totalRows;

            const container = document.getElementById('results-area');
            const desktopBody = document.getElementById('desktop-tbody');
            const mobileContainer = document.getElementById('mobile-cards');
            const status = document.getElementById('status-display');
            const countLabel = document.getElementById('res-count');

            if (!rows || rows.length === 0) {
                container.classList.add('hidden');
                status.innerHTML = `<p class="text-slate-500 font-bold text-sm">Ù†ØªÛŒØ¬Ù‡â€ŒØ§ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>`;
                status.classList.remove('hidden');
                return;
            }

            status.classList.add('hidden'); container.classList.remove('hidden');
            if(updateCount) countLabel.innerText = totalRows.toLocaleString('fa-IR');
            
            desktopBody.innerHTML = "";
            mobileContainer.innerHTML = "";
            const sanitize = (val) => {
                    if (!val) return '-';
                    // Use a regular expression to replace "none" case-insensitively, then trim whitespace.
                    const cleanedStr = String(val).replace(/none/gi, '').trim();
                    // If the string is empty after cleaning, return a hyphen. Otherwise, return the cleaned string.
                    return cleanedStr.length > 0 ? cleanedStr : '-';
                };
            rows.forEach((row, index) => {
                const rName = sanitize(row.FULL_NAME) || '-';
                const rCode = sanitize(row.NATIONAL_CODE) || '-';
                const rMob = sanitize(row.MOBILE) || '-';
                const rFather = sanitize(row.FATHER_NAME) || '-';
                const rCity = sanitize(row.CITY_NAME) || '-';
                const rAddr = sanitize(row.ADDRESS) || '-';
                
                let rBank = row.BANK_ACCOUNT || '-';
                let bankClass = "bg-slate-700 text-slate-300";
                if (rBank.includes("MELLAT")) { rBank = "Ù…Ù„Øª"; bankClass = "bg-red-500/20 text-red-400 border border-red-500/30"; }
                else if (rBank.includes("MELLI")) { rBank = "Ù…Ù„ÛŒ"; bankClass = "bg-blue-500/20 text-blue-400 border border-blue-500/30"; }

                const ncData = processNationalCode(rCode);
                const cityBadge = ncData.city ? `<span class="mr-1 text-[10px] bg-slate-700 px-1.5 rounded text-slate-300">${ncData.city}</span>` : '';

                // --- DESKTOP TABLE FIX ---
                desktopBody.innerHTML += `
                <tr class="hover:bg-white/5 border-b border-slate-700/50">
                    <td class="px-4 py-3 text-right font-bold text-white" dir="rtl">${rName}</td>
                    <td class="px-4 py-3 text-center"><div class="font-mono text-slate-400">${ncData.code}</div>${cityBadge}</td>
                    <td class="px-4 py-3 text-center font-mono text-slate-400">${rMob}</td>
                    <td class="px-4 py-3 text-right text-xs text-slate-400" dir="rtl">${rFather}</td>
                    <td class="px-4 py-3 text-right text-xs text-slate-500 truncate max-w-[200px]" title="${rAddr}" dir="rtl">${rAddr}</td>
                    <td class="px-4 py-3 text-center text-xs"><span class="px-2 py-1 rounded ${bankClass}">${rBank}</span></td>
                </tr>`;
                
                // --- MOBILE CARD FIX ---
                mobileContainer.innerHTML += `
                <div class="result-card glass-panel p-4 rounded-xl" style="animation-delay: ${index * 50}ms">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 bg-slate-700 rounded-full flex-shrink-0 flex items-center justify-center text-2xl text-slate-400"><i class="ri-user-3-line"></i></div>
                        <div class="flex-grow min-w-0">
                            <h3 class="font-bold text-white text-base truncate" dir="rtl">${rName}</h3>
                            <p class="text-xs text-slate-400 mt-0.5" dir="rtl">Ù¾Ø¯Ø±: ${rFather}</p>
                        </div>
                        <span class="px-2 py-1 rounded text-[10px] font-bold ${bankClass}">${rBank}</span>
                    </div>
                    <div class="mt-4 border-t border-slate-700/50 pt-3 grid grid-cols-2 gap-3 text-center text-sm">
                        <div class="bg-slate-900/50 p-2 rounded-lg border border-slate-700 active:bg-slate-700" onclick="copyToClip('${ncData.code}')">
                            <div class="text-[10px] text-slate-500 mb-1">Ú©Ø¯ Ù…Ù„ÛŒ</div><div class="font-mono text-slate-300 tracking-wider">${ncData.code}</div>
                            ${ncData.city ? `<div class="mt-1 text-[10px] text-slate-400">${ncData.city}</div>` : ''}
                        </div>
                        <div class="bg-slate-900/50 p-2 rounded-lg border border-slate-700 active:bg-slate-700" onclick="copyToClip('${rMob}')">
                            <div class="text-[10px] text-slate-500 mb-1">Ù…ÙˆØ¨Ø§ÛŒÙ„</div><div class="font-mono text-slate-300 tracking-wider">${rMob}</div>
                        </div>
                    </div>
                    <div class="details-section mt-2 border-t border-slate-700/50 text-xs">
                        <div class="text-slate-500">Ø´Ù‡Ø±: <span class="text-slate-300" dir="rtl">${rCity}</span></div>
                        <div class="text-slate-500 mt-1">Ø¢Ø¯Ø±Ø³: <span class="text-slate-300 whitespace-normal leading-relaxed" dir="rtl">${rAddr}</span></div>
                    </div>
                    <button class="w-full mt-2 text-center text-[10px] text-slate-500 hover:text-white" onclick="toggleDetails(this)">Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ±</button>
                </div>`;
            });
            updatePaginationUI();
        }

        function toggleDetails(button) { 
            const d=button.previousElementSibling; 
            if(d.classList.contains('open')){ 
                d.classList.remove('open'); 
                button.innerHTML='Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ±'; 
            } else { 
                d.classList.add('open'); 
                button.innerHTML='Ø¨Ø³ØªÙ†'; 
            } 
        }
        function updatePaginationUI() { 
            const p=document.getElementById('btn-prev'), n=document.getElementById('btn-next'), i=document.getElementById('page-info'), t=Math.ceil(totalSearchResults/HF_LENGTH), d=currentSearchPage+1; 
            i.innerText=`${d.toLocaleString('fa-IR')}/${t.toLocaleString('fa-IR')}`; 
            p.disabled=currentSearchPage===0; n.disabled=d>=t; 
        }
        function changePage(dir) { 
            const n=currentSearchPage+dir; 
            if(n>=0)
            { 
                executeSearch(n); 
                window.scrollTo({
                    top:0,behavior:'smooth'
                }); 
            } 
        }
        function showErrorState(msg) { 
            const c=document.getElementById('results-area'), s=document.getElementById('status-display'); c.classList.add('hidden'); 
            s.innerHTML=`<p class="text-red-400 font-bold text-sm">Ø®Ø·Ø§: ${msg}</p>`; s.classList.remove('hidden'); 
        }
        function setLoading(isLoading) { 
            const b=document.getElementById('btn-search'),s=document.getElementById('status-display'),r=document.getElementById('results-area'); 
            if(isLoading){
                b.disabled=true;b.innerHTML='<i class="ri-loader-4-line animate-spin text-xl"></i>';
                if(currentSearchPage===0)r.classList.add('hidden');
                s.classList.remove('hidden');
                s.innerHTML='<div class="loader mx-auto mb-2 border-t-red-500"></div><p class="text-slate-500 text-xs animate-pulse">Ø¬Ø³ØªØ¬Ùˆ...</p>';
            }else{
                b.disabled=false;b.innerHTML='<span class="md:hidden">Ø¬Ø³ØªØ¬Ùˆ</span><i class="ri-search-2-line text-xl"></i>';
            } 
        }
        function copyTable() { 
            if(lastResults.length===0)return; 
            let t="Ù†Ø§Ù…\tÚ©Ø¯Ù…Ù„ÛŒ\tÙ…ÙˆØ¨Ø§ÛŒÙ„\n"; 
            lastResults.forEach(r=>t+=`${r.FULL_NAME}\t${r.NATIONAL_CODE}\t${r.MOBILE}\n`); 
            navigator.clipboard.writeText(t); 
            alert("Ú©Ù¾ÛŒ Ø´Ø¯"); 
        }
        function exportJSON() { 
            if(lastResults.length===0)return; 
            const b=new Blob([JSON.stringify(lastResults,null,2)],{type:'application/json'}); 
            const a=document.createElement('a'); 
            a.href=URL.createObjectURL(b); 
            a.download='bank_leak.json'; 
            a.click(); 
        }
        
        init();
        handleUrlQuery();
    </script>
</body>
</html>
